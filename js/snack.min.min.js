/*!
  * snack.js (c) Ryan Florence
  * https://github.com/rpflorence/snack
  * MIT License
  * Inspiration and code adapted from
  *  MooTools      (c) Valerio Proietti   MIT license
  *  jQuery        (c) John Resig         Dual license MIT or GPL Version 2
  *  contentLoaded (c) Diego Perini       MIT License
  *  Zepto.js      (c) Thomas Fuchs       MIT License
*/typeof Object.create!="function"&&(Object.create=function(e){function t(){}t.prototype=e;return new t}),!function(e){var t=e.snack={},n=0,r=Object.prototype.toString,i=[].indexOf,s=[].push;t.extend=function(){if(arguments.length==1)return t.extend(t,arguments[0]);var e=arguments[0];for(var n,r=1,i=arguments.length;r<i;r++)for(n in arguments[r])e[n]=arguments[r][n];return e},t.extend({v:"1.2.3",bind:function(e,t,n){n=n||[];return function(){s.apply(n,arguments);return e.apply(t,n)}},punch:function(e,n,r,i){var s=e[n];e[n]=i?function(){s.apply(e,arguments);return r.apply(e,arguments)}:function(){var n=[].slice.call(arguments,0);n.unshift(t.bind(s,e));return r.apply(e,n)}},create:function(e,n){var r=Object.create(e);if(!n)return r;for(var i in n){if(!n.hasOwnProperty(i))continue;if(!e[i]||typeof n[i]!="function"){r[i]=n[i];continue}t.punch(r,i,n[i])}return r},id:function(){return++n},each:function(e,t,n){if(e.length===void 0){for(var r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e);return e}for(var i=0,s=e.length;i<s;i++)t.call(n,e[i],i,e);return e},parseJSON:function(t){if(typeof t=="string"){t=t.replace(/^\s+|\s+$/g,"");var n=/^[\],:{}\s]*$/.test(t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""));if(!n)throw"Invalid JSON";var r=e.JSON;return r&&r.parse?r.parse(t):(new Function("return "+t))()}},isArray:function(e){return e instanceof Array||r.call(e)=="[object Array]"},indexOf:i?function(e,t){return i.call(t,e)}:function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}})}(window),!function(e,t){var n={},r;e.wrap=function(t,i){typeof t=="string"&&(t=r(t,i)),t.length||(t=[t]);var s=Object.create(n),o=0,u=t.length;for(;o<u;o++)s[o]=t[o];s.length=u,s.id=e.id();return s},e.extend(e.wrap,{define:function(t,r){if(typeof t!="string")for(var i in t)e.wrap.define(i,t[i]);else n[t]=r},defineEngine:function(e){r=e}}),e.wrap.defineEngine(function(e,n){typeof n=="string"&&(n=t.querySelector(n));return(n||t).querySelectorAll(e)})}(snack,document),!function(e,t,n){function r(){try{l.doScroll("left")}catch(e){setTimeout(r,50);return}i("poll")}function i(r){if(r.type!="readystatechange"||n.readyState=="complete")(r.type=="load"?t:n)[o](u+r.type,i,!1),!a&&(a=!0)&&e.each(c,function(e){e.apply(n)})}var s=n.addEventListener?"addEventListener":"attachEvent",o=n.addEventListener?"removeEventListener":"detachEvent",u=n.addEventListener?"":"on",a=!1,f=!0,l=n.documentElement,c=[];e.extend({stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}}),e.listener=function(t,r){t.delegate&&(t.capture=!0,_handler=r,r=function(r){var i=r.target||r.srcElement,s=typeof t.delegate=="string"?e.wrap(t.delegate,t.node):t.delegate(t.node);while(i&&e.indexOf(i,s)==-1)i=i.parentNode;i&&i!==this&&i!==n&&_handler.call(i,r,i)}),t.context&&(r=e.bind(r,t.context));var i={attach:function(){t.node[s](u+t.event,r,t.capture)},detach:function(){t.node[o](u+t.event,r,t.capture)},fire:function(){r.apply(t.node,arguments)}};i.attach();return i},e.ready=function(e){a?e.apply(n):c.push(e)};if(n.createEventObject&&l.doScroll){try{f=!t.frameElement}catch(h){}f&&r()}n[s](u+"DOMContentLoaded",i,!1),n[s](u+"readystatechange",i,!1),t[s](u+"load",i,!1)}(snack,window,document),!function(e){e.publisher=function(t){var n={};t=t||{},e.extend(t,{subscribe:function(t,r,i){var s={fn:r,ctxt:i||{}};n[t]||(n[t]=[]);var o={attach:function(){n[t].push(s)},detach:function(){n[t].splice(e.indexOf(r,n[t]),1)}};o.attach();return o},publish:function(t,r){if(!n[t])return!1;e.each(n[t],function(e){e.fn.apply(e.ctxt,r||[])});return n[t].length}});return t},e.publisher(e)}(snack),!function(e,t,n){function r(){}e.JSONP=function(t,r){var i="jsonp"+e.id(),s=n.createElement("script"),o=!1;e.JSONP[i]=function(t){o=!1,delete e.JSONP[i],r(t)},typeof t.data=="object"&&(t.data=e.toQueryString(t.data));var u={send:function(){o=!0,s.src=t.url+"?"+t.key+"=snack.JSONP."+i+"&"+t.data,n.getElementsByTagName("head")[0].appendChild(s)},cancel:function(){o&&s.parentNode&&s.parentNode.removeChild(s),o=!1,e.JSONP[i]=function(){delete e.JSONP[i]}}};t.now!==!1&&u.send();return u},e.toQueryString=function(t,n){var r=[];e.each(t,function(t,i){n&&(i=n+"["+i+"]");var s;if(e.isArray(t)){var o={};e.each(t,function(e,t){o[t]=e}),s=e.toQueryString(o,i)}else typeof t=="object"?s=e.toQueryString(t,i):s=i+"="+encodeURIComponent(t);t!==null&&r.push(s)});return r.join("&")};var i=function(){var e=function(){return new XMLHttpRequest},t=function(){return new ActiveXObject("MSXML2.XMLHTTP")},n=function(){return new ActiveXObject("Microsoft.XMLHTTP")};try{e();return e}catch(r){try{t();return t}catch(r){n();return n}}}();e.request=function(t,n){if(!(this instanceof e.request))return new e.request(t,n);var r=this;r.options=e.extend({},r.options,t),r.callback=n,r.xhr=new i,r.headers=r.options.headers,r.options.now!==!1&&r.send()},e.request.prototype={options:{exception:r,url:"",data:"",method:"get",now:!0,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,emulation:!0,urlEncoded:!0,encoding:"utf-8"},onStateChange:function(){var e=this,t=e.xhr;if(t.readyState==4&&!!e.running){e.running=!1,e.status=0;try{var n=t.status;e.status=n==1223?204:n}catch(i){}t.onreadystatechange=r;var s=e.status>=200&&e.status<300?[!1,e.xhr.responseText||"",e.xhr.responseXML]:[e.status];e.callback.apply(e,s)}},setHeader:function(e,t){this.headers[e]=t;return this},getHeader:function(e){try{return this.xhr.getResponseHeader(e)}catch(t){return null}},send:function(){var t=this,r=t.options;if(t.running)return t;t.running=!0;var i=r.data||"",s=String(r.url),o=r.method.toLowerCase();typeof i!="string"&&(i=e.toQueryString(i));if(r.emulation&&e.indexOf(o,["get","post"])<0){var u="_method="+o;i=i?u+"&"+i:u,o="post"}if(r.urlEncoded&&e.indexOf(o,["post","put"])>-1){var f=r.encoding?"; charset="+r.encoding:"";t.headers["Content-type"]="application/x-www-form-urlencoded"+f}s||(s=n.location.pathname);var l=s.lastIndexOf("/");l>-1&&(l=s.indexOf("#"))>-1&&(s=s.substr(0,l)),i&&o=="get"&&(s+=(s.indexOf("?")>-1?"&":"?")+i,i=null);var h=t.xhr;h.open(o.toUpperCase(),s,open.async,r.user,r.password),r.user&&"withCredentials"in h&&(h.withCredentials=!0),h.onreadystatechange=e.bind(t.onStateChange,t);for(var p in t.headers)try{h.setRequestHeader(p,t.headers[p])}catch(d){r.exception.apply(t,[p,t.headers[p]])}h.send(i),r.async||t.onStateChange();return t},cancel:function(){var e=this;if(!e.running)return e;e.running=!1;var t=e.xhr;t.abort(),t.onreadystatechange=r,e.xhr=new i;return e}}}(snack,window,document),!function(e,t){function n(t,n,r,i){var s=t.data(r);s&&e.each(s,function(e){e[n].apply(t,i)});return t}function r(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}e.wrap.define({data:function(){var e={};return function(t,n){var r=e[this.id];r||(r=e[this.id]={});return n===void 1?r[t]:r[t]=n}}(),each:function(t,n){return e.each(this,t,n)},addClass:function(e){return this.each(function(t){r(t.className).indexOf(e)>-1||(t.className=r(t.className+" "+e))})},removeClass:function(e){return this.each(function(t){t.className=t.className.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)"),"$1")})},attach:function(t,n,r){var i=t.split("."),s=[];i[1]&&(s=this.data(i[1])||[]),this.each(function(t){var o={node:t,event:i[0]};r&&(o.delegate=r),s.push(e.listener(o,n))}),i[1]&&this.data(i[1],s);return this},detach:function(e){n(this,"detach",e,null,!0),this.data(e,null);return this},fire:function(e,t){return n(this,"fire",e,t)},delegate:function(e,t,n){return this.attach(e,n,t)}})}(snack,document);